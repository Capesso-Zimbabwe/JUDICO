{% extends 'governance/base.html' %}

{% block title %}Governance - Meetings{% endblock %}

{% block governance_content %}
    <!-- Meetings Management Table -->
    <div class="bg-white rounded-sm shadow-md flex flex-col overflow-hidden flex-1 max-w-full max-h-full">
        <div class="bg-white px-4 py-3 flex items-center justify-between">
            <form action="" class="flex-1 max-w-sm" id="search-form">
                <input type="text" name="search" value="{{ request.GET.search }}" placeholder="Search meetings..." class="block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </form>
            <div class="flex space-x-3">
                <button onclick="document.getElementById('fileInput').click()" class="p-2 flex gap-1 bg-green-600 hover:bg-green-700 text-white rounded">
                    <svg class="w-4 h-4 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <span class="font-bold">Upload Document</span>
                </button>
                <input type="file" id="fileInput" accept=".pdf,.doc,.docx" style="display: none;" onchange="handleFileUpload(event)">
                <a href="{% url 'governance:create_meeting' %}" class="p-2 flex gap-1 bg-blue-600 hover:bg-blue-700 text-white rounded">
                    <svg class="w-4 h-4 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14m-7 7V5"></path>
                    </svg>
                    <span class="font-bold">Schedule Meeting</span>
                </a>
            </div>
        </div>
        <div class="p-0 overflow-hidden flex flex-col flex-1 max-w-full max-h-full">
            <div class="compact-table flex-1 max-w-full max-h-full scrollbar-thin overflow-auto relative">

                <table class="w-full divide-y divide-gray-200" id="meetingsTable">
                    <thead class="bg-gray-100 whitespace-nowrap text-xs sticky top-0 z-10">
                        <tr>
                            <th class="px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200">
                                Meeting Title
                            </th>
                            <th class="px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200">
                                Type
                            </th>
                            <th class="px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200">
                                Date & Time
                            </th>
                            <th class="px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200">
                                Status
                            </th>
                            <th class="px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200">
                                Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for meeting in all_meetings %}
                         <tr class="hover:bg-gray-50 transition-colors duration-200">
                             <td class="px-3 py-1 whitespace-nowrap">
                                 <div class="text-xs font-medium text-gray-900">{{ meeting.title }}</div>
                                 <div class="text-xs text-gray-500 mt-1">{{ meeting.description|truncatechars:50 }}</div>
                             </td>
                             <td class="px-3 py-1 whitespace-nowrap text-xs text-gray-700">
                                 <span class="inline-flex rounded-full bg-blue-100 px-2 text-xs font-medium leading-5 text-blue-700">{{ meeting.get_meeting_type_display }}</span>
                             </td>
                             <td class="px-3 py-1 whitespace-nowrap text-xs text-gray-700">
                                 <div>{{ meeting.date|date:"M j, Y" }}</div>
                                 <div class="text-gray-500">{{ meeting.date|date:"g:i A" }}</div>
                             </td>
                             <td class="px-3 py-1 whitespace-nowrap text-xs">
                                {% if meeting.status == 'scheduled' %}
                                    <span class="inline-flex rounded-full bg-green-100 px-2 text-xs font-medium leading-5 text-green-700">{{ meeting.get_status_display }}</span>
                                {% elif meeting.status == 'completed' %}
                                    <span class="inline-flex rounded-full bg-gray-100 px-2 text-xs font-medium leading-5 text-gray-700">{{ meeting.get_status_display }}</span>
                                {% elif meeting.status == 'cancelled' %}
                                    <span class="inline-flex rounded-full bg-red-100 px-2 text-xs font-medium leading-5 text-red-700">{{ meeting.get_status_display }}</span>
                                {% else %}
                                    <span class="inline-flex rounded-full bg-yellow-100 px-2 text-xs font-medium leading-5 text-yellow-700">{{ meeting.get_status_display }}</span>
                                {% endif %}
                            </td>
                            <td class="px-3 py-1 whitespace-nowrap text-xs font-medium">
                                 <div class="flex space-x-2">
                                     <a href="{% url 'governance:view_meeting' meeting.id %}" class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-green-100 text-green-600 hover:bg-green-200 hover:text-green-700 transition-all duration-200 shadow-sm hover:shadow-md" title="View Meeting">
                                         <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                             <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path>
                                         </svg>
                                     </a>
                                     <a href="{% url 'governance:edit_meeting' meeting.id %}" class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 hover:text-blue-700 transition-all duration-200 shadow-sm hover:shadow-md" title="Edit Meeting">
                                         <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                             <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path>
                                         </svg>
                                     </a>
                                     <a href="{% url 'governance:delete_meeting' meeting.id %}" class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-red-100 text-red-600 hover:bg-red-200 hover:text-red-700 transition-all duration-200 shadow-sm hover:shadow-md" title="Delete Meeting" onclick="return confirm('Are you sure you want to delete this meeting?')">
                                         <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                             <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path>
                                         </svg>
                                     </a>
                                 </div>
                             </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="px-3 py-8 text-center text-gray-500 text-sm">
                                <div class="flex flex-col items-center">
                                    <svg class="w-12 h-12 text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <p class="text-gray-500 text-sm">No meetings found</p>
                                    <p class="text-gray-400 text-xs mt-1">Schedule your first meeting to get started</p>
                                    <div class="mt-4">
                                        <a href="{% url 'governance:create_meeting' %}" class="inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-xs font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="-ml-1 mr-2 h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                                            </svg>
                                            Schedule Meeting
                                        </a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                         </tbody>
                     </table>
                 </div>
             </div>
         </div>
         
        {% include 'components/paginator.html' %}
     </div>
    
    <script>
    function handleFileUpload(event) {
        const file = event.target.files[0];
        if (file) {
            // Check file type
            const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            if (!allowedTypes.includes(file.type)) {
                alert('Please select a PDF, DOC, or DOCX file.');
                event.target.value = '';
                return;
            }
            
            // Check file size (10MB limit)
            const maxSize = 10 * 1024 * 1024; // 10MB in bytes
            if (file.size > maxSize) {
                alert('File size must be less than 10MB.');
                event.target.value = '';
                return;
            }
            
            // Confirm upload
            if (confirm(`Upload "${file.name}"?`)) {
                // Here you would typically submit the file to your server
                alert('File upload functionality would be implemented here.');
            }
            
            // Reset the input
            event.target.value = '';
        }
    }
    </script>
{% endblock %}