<!-- Update Expense Modal -->
<div id="{{ modal_id|default:'update-expense-modal' }}" tabindex="-1" aria-hidden="true" data-modal-backdrop="static" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative p-4 w-full max-w-2xl max-h-full">
        <!-- Modal content -->
        <div class="relative bg-white rounded-sm shadow-sm">
            <!-- Modal header -->
            <div class="flex items-center justify-between px-4 md:px-5 py-3 border-b rounded-t border-gray-200">
                <h3 class="text-base font-semibold text-gray-900">
                    Update Expense
                </h3>
                <button type="button" class="text-gray-400 cursor-pointer bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center" data-modal-hide="{{ modal_id|default:'update-expense-modal' }}">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="p-6 space-y-6">
                <form id="updateExpenseForm" method="post" enctype="multipart/form-data"
                      hx-target="#update-expense-modal-container"
                      hx-swap="outerHTML">
                    {% csrf_token %}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="md:col-span-2">
                            <label for="updateExpenseTitle" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Expense Title</label>
                            <input type="text" id="updateExpenseTitle" name="title" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" placeholder="e.g., Office Supplies" value="{{ expense.title|default:'' }}" required>
                        </div>
                        <div>
                            <label for="updateExpenseAmount" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Amount</label>
                            <input type="number" step="0.01" id="updateExpenseAmount" name="amount" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" placeholder="0.00" value="{{ expense.amount|default:'0.00' }}" required>
                        </div>
                        <div>
                            <label for="updateExpenseCategory" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Category</label>
                            <select id="updateExpenseCategory" name="category" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required>
                                <option value="">Select Category</option>
                                <option value="OFFICE_SUPPLIES" {% if expense.category == 'OFFICE_SUPPLIES' %}selected{% endif %}>Office Supplies</option>
                                <option value="UTILITIES" {% if expense.category == 'UTILITIES' %}selected{% endif %}>Utilities</option>
                                <option value="RENT" {% if expense.category == 'RENT' %}selected{% endif %}>Rent</option>
                                <option value="TRAVEL" {% if expense.category == 'TRAVEL' %}selected{% endif %}>Travel</option>
                                <option value="PROFESSIONAL_FEES" {% if expense.category == 'PROFESSIONAL_FEES' %}selected{% endif %}>Professional Fees</option>
                                <option value="MARKETING" {% if expense.category == 'MARKETING' %}selected{% endif %}>Marketing</option>
                                <option value="OTHER" {% if expense.category == 'OTHER' %}selected{% endif %}>Other</option>
                            </select>
                        </div>
                        <div>
                            <label for="updateExpenseDate" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Expense Date</label>
                            <input type="date" id="updateExpenseDate" name="expense_date" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" value="{{ expense.expense_date|date:'Y-m-d'|default:'' }}" required>
                        </div>
                        <div>
                            <label for="updateExpenseReceipt" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Receipt</label>
                            <input type="file" id="updateExpenseReceipt" name="receipt" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" accept=".pdf,.jpg,.jpeg,.png">
                            {% if expense.receipt %}
                            <p class="mt-1 text-xs text-gray-500">Current: <a href="{{ expense.receipt.url }}" target="_blank" class="text-blue-600 hover:underline">{{ expense.receipt.name }}</a></p>
                            {% endif %}
                        </div>
                        <div class="md:col-span-2">
                            <label for="updateExpenseDescription" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Description (Optional)</label>
                            <textarea id="updateExpenseDescription" name="description" rows="3" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" placeholder="Expense description...">{{ expense.description|default:'' }}</textarea>
                        </div>
                    </div>
                </form>
            </div>
            <!-- Modal footer -->
            <div class="flex items-center p-6 space-x-2 border-t border-gray-200 rounded-b dark:border-gray-600">
                <button type="submit" form="updateExpenseForm" class="w-full text-xs bg-blue-900 text-white py-2 px-3 font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm disabled:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed submit-btn rounded-none">Update Expense</button>
                <button data-modal-hide="{{ modal_id|default:'update-expense-modal' }}" type="button" class="w-full text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 py-2 px-3 font-medium transition-all duration-200 rounded-none">Cancel</button>
            </div>
        </div>
    </div>
</div>